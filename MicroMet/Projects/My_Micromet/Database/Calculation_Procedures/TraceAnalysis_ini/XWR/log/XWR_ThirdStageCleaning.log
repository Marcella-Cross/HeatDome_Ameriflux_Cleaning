
Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric


Attaching package: 'dplyr'

The following objects are masked from 'package:stats':

    filter, lag

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union


Attaching package: 'lubridate'

The following objects are masked from 'package:base':

    date, intersect, setdiff, union


Attaching package: 'data.table'

The following objects are masked from 'package:lubridate':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following objects are masked from 'package:dplyr':

    between, first, last

The following objects are masked from 'package:zoo':

    yearmon, yearqtr


Attaching package: 'reshape2'

The following objects are masked from 'package:data.table':

    dcast, melt

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats 1.0.0     ✔ readr   2.1.5
✔ ggplot2 3.5.1     ✔ tibble  3.2.1
✔ purrr   1.0.4     ✔ tidyr   1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ data.table::between() masks dplyr::between()
✖ dplyr::filter()       masks stats::filter()
✖ data.table::first()   masks dplyr::first()
✖ data.table::hour()    masks lubridate::hour()
✖ data.table::isoweek() masks lubridate::isoweek()
✖ dplyr::lag()          masks stats::lag()
✖ data.table::last()    masks dplyr::last()
✖ data.table::mday()    masks lubridate::mday()
✖ data.table::minute()  masks lubridate::minute()
✖ data.table::month()   masks lubridate::month()
✖ data.table::quarter() masks lubridate::quarter()
✖ data.table::second()  masks lubridate::second()
✖ purrr::transpose()    masks data.table::transpose()
✖ data.table::wday()    masks lubridate::wday()
✖ data.table::week()    masks lubridate::week()
✖ data.table::yday()    masks lubridate::yday()
✖ data.table::year()    masks lubridate::year()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift

[1] "R version 4.4.3 (2025-02-28 ucrt)"
[1] "ReddyProc version: 1.3.3"
[1] "Third stage run initialized for XWR data in /Users/Marcella Cross/Desktop/HeatDome_Ameriflux_Cleaning/MicroMet/Projects/My_Micromet/Database"
[1] "3110 values in H were filtered by the wind sector filter"
[1] "3157 values in LE were filtered by the wind sector filter"
[1] "2991 values in NEE were filtered by the wind sector filter"
[1] "Writing 2022"
[1] "Writing DateTime"
[1] "Writing H"
[1] "Writing LE"
[1] "Writing NEE"
[1] "Copying H from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Copying LE from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Copying NEE from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Writing 2022"
[1] "Writing DateTime"
[1] "Writing H_PI_SC"
[1] "Writing LE_PI_SC"
[1] "Writing NEE_PI_SC"
[1] "Copying H_PI_SC from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Copying LE_PI_SC from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Copying NEE_PI_SC from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "32 values in H were filtered out by moving Z score filter"
[1] "118 values in LE were filtered out by moving Z score filter"
[1] "4 values in NEE were filtered out by moving Z score filter"
[1] "Writing 2022"
[1] "Writing DateTime"
[1] "Writing H_PI_SC_JSZ"
[1] "Writing LE_PI_SC_JSZ"
[1] "Writing NEE_PI_SC_JSZ"
[1] "Copying H_PI_SC_JSZ from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Copying LE_PI_SC_JSZ from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Copying NEE_PI_SC_JSZ from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "222 values in H were filtered out by Night-time MAD spike filter"
[1] "289 values in H were filtered out by Day-time MAD spike filter"
[1] "401 values in LE were filtered out by Night-time MAD spike filter"
[1] "472 values in LE were filtered out by Day-time MAD spike filter"
[1] "6 values in NEE were filtered out by Night-time MAD spike filter"
[1] "11 values in NEE were filtered out by Day-time MAD spike filter"
[1] "Writing 2022"
[1] "Writing DateTime"
[1] "Writing H_PI_SC_JSZ_MAD"
[1] "Writing LE_PI_SC_JSZ_MAD"
[1] "Writing NEE_PI_SC_JSZ_MAD"
[1] "Copying H_PI_SC_JSZ_MAD from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Copying LE_PI_SC_JSZ_MAD from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
[1] "Copying NEE_PI_SC_JSZ_MAD from Clean/ThirdStage_Default_Ustar to Clean/ThirdStage"
New sEddyProc class for site 'XWR'

Estimated UStar distribution of:
   uStar 5% 50% 95%
1    NA NA  NA  NA 
by using  200 bootstrap samples and controls:
                       taClasses                    UstarClasses 
                              7                              20 
                          swThr            minRecordsWithinTemp 
                             10                             100 
         minRecordsWithinSeason            minRecordsWithinYear 
                            160                            3000 
isUsingOneBigSeasonOnFewRecords 
                              1 
Initialized variable 'Rg' with 856 real gaps for gap filling of all 17519 values (to estimate uncertainties).
Restriced MDS algorithm for gap filling of 'Rg' with no meteo conditions and hence only MDC.
Mean diurnal course with window size of 0 days: .
............................................................
.............................................................
........................................................16708
Mean diurnal course with window size of 1 days: .
........701
Mean diurnal course with window size of 2 days: .
.110
Finished gap filling of 'Rg' in 4 seconds. Artificial gaps filled: 17519, real gaps filled: 856, unfilled (long) gaps: 0.
Initialized variable 'Tair' with 844 real gaps for gap filling of all 17519 values (to estimate uncertainties).
Limited MDS algorithm for gap filling of 'Tair' with LUT(Rg only) and MDC.
Look up table with window size of 7 days with Rg
............................................................
.............................................................
........................................................16660
Mean diurnal course with window size of 0 days: .
........50
Mean diurnal course with window size of 1 days: .
........699
Mean diurnal course with window size of 2 days: .
.110
Finished gap filling of 'Tair' in 6 seconds. Artificial gaps filled: 17519, real gaps filled: 844, unfilled (long) gaps: 0.
Initialized variable 'VPD' with 4956 real gaps for gap filling of all 17519 values (to estimate uncertainties).
Limited MDS algorithm for gap filling of 'VPD' with LUT(Rg only) and MDC.
Look up table with window size of 7 days with Rg
............................................................
.............................................................
........................................................14164
Mean diurnal course with window size of 0 days: .
.................................24
Mean diurnal course with window size of 1 days: .
.................................326
Mean diurnal course with window size of 2 days: .
..............................68
Look up table with window size of 14 days with Rg
.............................1197
Look up table with window size of 21 days with Rg
.................1105
Look up table with window size of 28 days with Rg
......190
Look up table with window size of 35 days with Rg
....5
Look up table with window size of 42 days with Rg
....0
Look up table with window size of 49 days with Rg
....0
Look up table with window size of 56 days with Rg
....0
Look up table with window size of 63 days with Rg
....0
Look up table with window size of 70 days with Rg
....0
Mean diurnal course with window size of 7 days: .
....182
Mean diurnal course with window size of 14 days: .
..129
Mean diurnal course with window size of 21 days: .
.129
Finished gap filling of 'VPD' in 8 seconds. Artificial gaps filled: 17519, real gaps filled: 4956, unfilled (long) gaps: 0.
Initialized variable 'rH' with 1636 real gaps for gap filling of all 17519 values (to estimate uncertainties).
Full MDS algorithm for gap filling of 'rH' with LUT(Rg, VPD, Tair) and MDC.
Look up table with window size of 7 days with Rg VPD Tair
............................................................
.............................................................
........................................................12469
Look up table with window size of 14 days with Rg VPD Tair
..................................................63
Look up table with window size of 7 days with Rg
.................................................4129
Mean diurnal course with window size of 0 days: .
........40
Mean diurnal course with window size of 1 days: .
........689
Mean diurnal course with window size of 2 days: .
.129
Finished gap filling of 'rH' in 10 seconds. Artificial gaps filled: 17519, real gaps filled: 1636, unfilled (long) gaps: 0.

<P2M>Error!!! REddyProc crashed!</P2M>

<P2M> Search the log file for "abc123". Error that caused crash printed below </P2M>
<simpleError in .self$sMDSGapFillAfterUstar(..., uStarTh = uStarTh[, c(1L, 1L +     iCol)], uStarSuffix = uStarSuffixes[iCol]): must provide finite uStarThresholds>
Warning messages:
1: In fCheckHHTimeSeries(Data[[ColPOSIXTime]], DTS = DTS, "sEddyProc.initialize") :
  sEddyProc.initialize:::fCheckHHTimeSeries::: Data not provided in full days (multiple of daily time step). One day only has 47 (half-)hours!
2: In fCheckHHTimeSeries(Data[[ColPOSIXTime]], DTS = DTS, "sEddyProc.initialize") :
  sEddyProc.initialize:::fCheckHHTimeSeries::: Time stamp of first data row is not at the end of the first half-hour: 01:00 instead of 00:30!
3: In fCheckOutsideRange(Data.F, VarName.V.s[v.i], c("<", 0), SubCallFunc.s) :
  sEddyProc.initialize:::fCheckColPlausibility:::fCheckOutsideRange::: Variable outside (plausible) range in 6436 cases! Invalid values with 'Rg < 0': -0.877, -0.973, -0.843, -0.947, -1.000, -0.793, -0.817, -1.123, -0.997, -0.810, -0.510, -0.087, -0.660, -0.383, -0.143, -0.080, -0.020, -0.073, -0.270, -0.623, -0.077, -0.467, -0.637, -0.807, -0.333, -0.820, -0.617, -0.670, -0.450, -0.303, -0.503, -0.677, -0.730, -0.667, -0.413, -0.567, -0.833, -0.760, -1.043, -1.463, -1.383, -1.210, -1.330, -1.263, -1.463, -1.660, -1.553, -1.490, -1.500, -1.463 ...
4: In fCheckOutsideRange(Data.F, VarName.V.s[v.i], c("<", 0), SubCallFunc.s) :
  sEddyProc.initialize:::fCheckColPlausibility:::fCheckOutsideRange::: Variable outside (plausible) range in 922 cases! Invalid values with 'VPD < 0': -0.013, -0.011, -0.031, -0.027, -0.012, -0.055, -0.045, -0.032, -0.054, -0.018, -0.035, -0.027, -0.041, -0.062, -0.067, -0.072, -0.069, -0.077, -0.079, -0.085, -0.089, -0.100, -0.098, -0.069, -0.051, -0.032, -0.082, -0.095, -0.112, -0.127, -0.134, -0.138, -0.129, -0.126, -0.134, -0.142, -0.155, -0.157, -0.161, -0.160, -0.161, -0.160, -0.160, -0.159, -0.172, -0.174, -0.176, -0.149, -0.122, -0.101 ...
5: In .estimateUStarSeason(...) :
  sEstUstarThreshold: too few finite records within season (n = 286) for 7 temperature classes. Need at least n = 700. Returning NA for this Season.
6: In .estimateUStarSeason(...) :
  sEstUstarThreshold: too few finite records within season (n = 99). Need at least n = 160. Returning NA for this Season.
7: In .estimateUStarSeason(...) :
  sEstUstarThreshold: too few finite records within season (n = 16). Need at least n = 160. Returning NA for this Season.
8: In .estimateUStarSeason(...) :
  sEstUstarThreshold: too few finite records within season (n = 71). Need at least n = 160. Returning NA for this Season.
9: In .estimateUStarSeason(...) :
  sEstUstarThreshold: too few finite records within season (n = 472) for 7 temperature classes. Need at least n = 700. Returning NA for this Season.
10: In .self$sSetUstarScenarios(usGetAnnualSeasonUStarMap(resDf)) :
  Provided non-finite uStarThreshold for some periods. All values in corresponding period will be marked as gap.
[1] "Skipping RF_GapFilling"
[1] "Stage 3 Complete, total run time:"
Time difference of 1.708958 mins
=============================================================
Completed running Third Stage Rscript: C:\Program Files\R\R-4.4.3\bin\Rscript.exe
=============================================================


Command output:





=============================================================
Rscript:      C:\Program Files\R\R-4.4.3\bin\Rscript.exe
Command line: "C:\Program Files\R\R-4.4.3\bin\Rscript.exe" --vanilla "C:\Users\Marcella Cross\Desktop\HeatDome_Ameriflux_Cleaning\MicroMet\Projects\Biomet.net\R\database_functions\ThirdStage.R" "/Users/Marcella Cross/Desktop/HeatDome_Ameriflux_Cleaning/MicroMet/Projects/My_Micromet/Database" XWR 2022 2022 2> "\Users\Marcella Cross\Desktop\HeatDome_Ameriflux_Cleaning\MicroMet\Projects\My_Micromet\Database\Calculation_Procedures\TraceAnalysis_ini\XWR\log\XWR_ThirdStageCleaning.log" 1>&2
Start:        20-Jun-2025 10:30:06
End:          20-Jun-2025 10:31:53
Elapsed time:    1.8 min
==============================================================
